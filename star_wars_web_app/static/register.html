<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset="UTF-8" />
        <meta name = "viewport" content = "width=device-width", inital-scale="1.0"/>
        <title> Document</title>
        <a href="./add_media.html"> Add Media</a>
        <a href="../views/main_display.ejs"> Show All Media</a>
    </head>
    <body>
        <h1>Hello</h1>

        <h1>Registration</h1>
        <!-- Creating a form 1st-->
        <form id = "registration_form">
            <input type = "text" id = "email" placeholder = "Email" />
            <input type = "text" id = "username" placeholder = "Username" />
            <input type = "text" id = "password" placeholder = "Password" />
            <!-- Then click on submit button-->
            <input type = "submit" value = "Submit Form" />
            <!--Whenever somebody clicks on the submit form, the registerUser function gets called-->
            <!--Then that request is made to the server-->
            <!-- Result variable is what the server responds-->
        </form>

        <script>
            const form = document.getElementById('registration_form')
            form.addEventListener('submit', registerUser)

            //send data multiple ways:

            //1. Send data as Json (very common when you're using JS)
                // using this

            //2. Send data as URL encoded
                // by default when forms are used, it uses url encoded
                //popular in PHP
            async function registerUser(event){
                //Default of the forms is to refreas the page, want to stop that
                event.preventDefault()

                //Need the value of these, not just the document.getElebyID('stuff')
                const email = document.getElementById('email').value
                const username = document.getElementById('username').value
                const password = document.getElementById('password').value
                //now want to send this data to node server

                const result = await fetch('/api/register',{
                //when sending data as JSON, this is the way:
                    method: 'POST',
                    headers:{
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email, 
                        username, 
                        password
                    })
                }).then((res) => res.json()) // result from server into json

                //console.log(result)

                if (result.status === 'ok') {
					// everythign went fine
					alert('Success')
				} else {
					alert(result.error)
				}

            }
        </script>
    </body>
</html>